<div class="container">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <app-menuadmin></app-menuadmin>

  <section class="main-content">
    <h2>Administrar habitaciones</h2>
    <div *ngIf="cargando" class="mensaje-info">Cargando...</div>
    <div *ngIf="error" class="mensaje-error">{{ error }}</div>

    <br>
    <div *ngFor="let tipo of tiposDeHabitaciones" class="bloque-habitaciones">
      <h3 class="titulo-habitacion">
        {{ tipo.nombre }}
        <button class="btn-accion editar" (click)="editarTipoHabitacion(tipo.idTipoHabitacion)">
          <i class="fas fa-edit"></i>
        </button>
      </h3>

      <table class="table-responsive" *ngIf="habitacionesPorTipo(tipo.nombre).length">
        <thead>
          <tr>
            <th>Nº Habitación</th>
            <th>Estado</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let h of habitacionesPorTipo(tipo.nombre)">
            <td data-label="Nº Habitación"><span>{{ h.NumeroHabitacion }}</span></td>
            <td data-label="Tipo">
              <input type="checkbox" [checked]="h.Estado !== 'Deshabilitada'" />
            </td>
          </tr>
        </tbody>
      </table>

      <div *ngIf="!habitacionesPorTipo(tipo.nombre).length && !cargando && !error" class="mensaje-info">
        No hay registros de habitaciones para este tipo.
      </div>
    </div>




  </section>
</div>

<div class="modal-backdrop" *ngIf="mostrarModal">

  <div class="modal-container" [ngClass]="{ 'cerrando': cerrandoModal }" (animationend)="onAnimationEnd('modal')">

    <div class="modal-body">

      <div class="modal-titulo-row">
        <h3>{{ tipoHabitacion.nombre }}</h3>
        <div class="tarifa">
          <label>Tarifa Diaria:</label>
          <input type="number" [(ngModel)]="tipoHabitacion.precio" />
        </div>
      </div>

      <div class="modal-editor">
        <div class="editor-header">
          <span>Editar descripción</span>
          <button class="btn-lapiz">✎</button>
        </div>
        <div class="editor-contenido">
          <textarea [(ngModel)]="tipoHabitacion.descripcion" rows="6" class="textarea-estilizada"></textarea>
        </div>
      </div>

      <div class="modal-imagenes">
        <div class="imagen-actual">
          <label>Imagen actual</label>
          <div class="imagen-preview">
            <img [src]="tipoHabitacion.imagen" alt="Imagen actual" />
          </div>
        </div>

        <div class="subir-imagen">
          <label>Subir nueva imagen</label>
          <div class="input-upload">
            <input type="file" (change)="onImagenSeleccionada($event)" accept="image/*" />
          </div>
        </div>
      </div>

      <div class="modal-footer">
        <button class="btn-confirm" (click)="actualizarTipoHabitacion()">Aceptar</button>
        <button class="btn-cancel" (click)="cerrarModal()">Cancelar</button>
      </div>
    </div>

  </div>
</div>